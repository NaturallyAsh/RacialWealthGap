---
title: "Project"
date: "Last compiled on: `r Sys.Date()`"
output: html_notebook
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  eval = TRUE,
  echo = FALSE,
  message = FALSE,
  warning = FALSE
  )

library(knitr)
library(kableExtra)
library(scales)
library(plotly)
library(xfun)
library(tidyverse)
library(hrbrthemes)
library(ggtext)
library(grid)
library(gridExtra)
library(gridtext)

pkg_load2(c("htmltools", "mime"))

source("scripts/rw_datasets.R", local = knit_global())
source("scripts/rw_datasets_desc.R", local = knit_global())
source("theme/my_swd_theme.R")
```
## Racial Wealth Gap {.tabset}

### **Synopsis**

**Problem:**
Racial wealth inequality has not decreased over the last 50 years, and the gap is still very large. This gap persists due to inequities in wealth, income, education, among others, and are largely attributable to decades of institutionalized and systemic racism. The purpose of this analysis is to explore racial wealth trends from 1963 to 2016 and analyze the gaps.

------------

**Packages Required:**
```
library(tidyverse)
library(knitr)
library(kableExtra)
library(scales)
library(plotly)
library(xfun)
library(ggtext)
library(grid)
library(gridExtra)
library(gridtext)
```
-------------

### Data Preparation {.tabset}

#### Data Import
The 10 datasets originally pulled from the [Urban Institute](https://apps.urban.org/features/wealth-inequality-charts/) and [US Census](https://www.census.gov/data/tables/time-series/demo/income-poverty/historical-income-households.html).  

Retrievable from this [Github Repo](https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-02-09).  
<hr>

```
lifetime_earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv')
```
```
student_debt <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv')
```
```
retirement <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv')
```
```
home_owner <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv')
```
```
race_wealth <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv')
```
```
income_time <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv')
```
```
income_limits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv')
```
```
income_aggregate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv')
```
```
income_distribution <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv')
```
```
income_mean <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv')
```

#### Data Dictionary



`lifetime_earn.csv` ([Source:](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv)):

Average lifetime earning by race/gender

```{r}
kable(data1.desc)
```
***

`student_dept.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv)):

Average family student load debt for aged 25-55, by race and year normalized to 2016 dollars.  

```{r}
kable(data2.desc)
```
***

`retirement.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv)):

Average family liquid retirement savings normalized to 2016 dollars.

```{r}
kable(data3.desc)
```
***

`home_owner.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv)):

Home ownership percentage for families.

```{r}
kable(data4.desc)
```
***

`race_wealth.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv)):  
Family wealth by race/year/measure normalized to 2016, with measures of central tendency with mean and median.

```{r}
kable(data5.desc)
```
***

`income_time.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv)):  
Family-level income by percentile and year.

```{r}
kable(data6.desc)
```
***

`income_limits.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv)):  
Familial income limits for each fifth and top 5% of households by year and race.

```{r}
kable(data7.desc)
```
***

`income_aggregate.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv)):  
Share of aggregate income received by each fifth and top 5% of each racial group/household.

```{r}
kable(data8.desc)
```
***

`income_distribution.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv)):  
Households by total money income, race, and hispanic origin of householder separated by year and income groups.

```{r}
kable(data9.desc)
```
***

`income_mean.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv)):  
Mean income received by each fifth and top 5% of each racial group.

```{r}
kable(data10.desc)
```

### Exploratory Data Analysis (EDA) {.tabset}

#### Family Wealth Analysis

**Average family wealth (1963-2016)**  
Family wealth a a family's assets (i.e., savings, real estate, businesses) minus debt. Average wealth is indicative of the prosperity of a group as a whole in relation to other groups.


```{r}
race_mean_time <- race_wealth |> 
  filter(type == "Average", race %in% c("Black", "Non-White", "White")) |> # filter by average wealth (other option is by median)
  group_by(year, race) |> 
  mutate(race = as_factor(race)) |> 
  summarise(wealth_family = wealth_family, .groups = "drop") |> # explicitly drop groups using .groups = "drop"
  drop_na()


line_1963_grob <- segmentsGrob(
  x0 = unit(0.045, "npc"),
  y0 = unit(.17, "npc"),
  x1 = unit(0.045, "npc"),
  y1 = unit(0.065, "npc"),
  default.units = "npc",
  arrow = NULL, name = NULL, gp = gpar(col = SILVER), vp = NULL
)

times_6.2_grob <- grobTree(richtext_grob(
  c("<span style='font-size:10pt'>In 1963</span>","<span style=color:ORANGERED>6.2X</span>","<span style='font-size:10pt'>greater</span>"),
  x = c(.1,.1,.1),
  y = c(.45,.35,.29),
  align_widths = TRUE,
  padding = unit(c(5,5,5,5), "pt"),
  gp = gpar(fontsize = 20, col = BLUEGRAY)
))

times_6.6_grob <- grobTree(richtext_grob(
  c("<span style='font-size:10pt'>In 2016</span>","<span style=color:PURPLE>6.6X</span>","<span style='font-size:10pt'>greater</span>"),
  x = c(.9,.9,.9),
  y = c(.45,.35,.29),
  align_widths = TRUE,
  padding = unit(c(5,5,5,5), "pt"),
  gp = gpar(fontsize = 20, col = BLUEGRAY)
))


line_2016_grob <- segmentsGrob(
  x0 = unit(0.955, "npc"),
  y0 = unit(.88, "npc"),
  x1 = unit(0.955, "npc"),
  y1 = unit(0.177, "npc"),
  default.units = "npc",
  arrow = NULL, name = NULL, gp = gpar(col = SILVER), vp = NULL
)
```

```{r}
ggplot(race_mean_time, aes(x = year, y = wealth_family, color = race)) +
  geom_point(data = race_mean_time |> filter(year == 2016 | year == 1963)) +
  geom_line() +
  scale_color_brewer(palette = "Set2") +
  scale_y_continuous(limits = c(0, 1000000), breaks = seq(0, 1000000, 200000), labels = label_dollar()) +
  annotation_custom(line_1963_grob) +
  annotation_custom(line_2016_grob) +
  annotation_custom(times_6.2_grob) +
  annotation_custom(times_6.6_grob) +
  labs(
    title = "Average family wealth over time, by race",
    x = "Year",
    y = "Family Wealth",
  ) +
  my_swd_theme() + theme(
    legend.position = "top",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    plot.title = element_text(size = 14, face = "bold"),
    legend.title = element_blank()
  )
```


In 1963, the average wealth of white families was \$121,129, which is **6.2 times** greater than the average wealth of non-white families of \$19,503. In 2016, White average wealth of \$919,336 was **6.6 times** greater than Black average wealth of $139,523. This gap trend has slowly widened over time, highlighting the growing disparities.
<br><br>


#### Income Analysis

**Lifetime Earnings**  
Those with lesser incomes might find it more difficult to save. 
<br><br>

```{r}

lifetime_earn_plot <- lifetime_earn |> 
  mutate(
    race = as_factor(race)
  ) |> 
  drop_na()

life_color_scale <- c(
  "White" = BLUEGRAY,
  "Black" = LIGHTGRAY,
  "Hispanic any race" = LIGHTGRAY
)
```

```{r}
ggplot(lifetime_earn_plot, aes(x = race, y = lifetime_earn, fill = race)) + 
  geom_col(color = "grey") + 
  scale_y_continuous(limits = c(0, 3000000), breaks = seq(0, 3000000, 750000), labels = label_dollar()) +
  scale_fill_manual(values = life_color_scale) +
  facet_wrap(~gender) +
  labs(
    title = "Lifetime Earnings Inequity",
    subtitle = "Average Accumulated Real Lifetime Earnings at Ages 58â€“62 (Born 1950-54) by Gender and Race/Ethnicity",
    y = "Lifetime Earnings"
  ) +
  theme_bw() + theme(
    panel.grid = element_blank(),
    axis.text.x = element_blank(),
    axis.title.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    legend.position = c(.85, .80),
    plot.title = element_text(size = 16, face = "bold"),
    # plot.title.position = "plot",
    plot.subtitle = element_text(size = 9, margin = margin(0,0,.5,0,"cm")),
    plot.margin = margin(1, .5, 1, .5, "cm"),
  )
```


The average lifetime income of a white male is \$2.7 million, compared to \$1.8 million for black men and \$2.0 million for Hispanic men. For women, the disparity in lifetime earnings is less pronounced: the average white woman makes \$1.5 million, compared to \$1.3 million for black women and $1.1 million for Hispanic women. Part of these differences can be attributed to historical disadvantages that still have an impact on future generations.

<br><br>
















