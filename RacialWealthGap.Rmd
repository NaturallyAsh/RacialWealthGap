---
title: "Project"
date: "Last compiled on: `r Sys.Date()`"
output: html_notebook
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
  eval = TRUE,
  echo = FALSE,
  message = FALSE,
  warning = FALSE
  )

library(knitr)
library(kableExtra)
library(scales)
library(plotly)
library(xfun)
library(tidyverse)
library(hrbrthemes)

pkg_load2(c("htmltools", "mime"))

source("scripts/rw_datasets.R", local = knit_global())
source("scripts/rw_datasets_desc.R", local = knit_global())
source("theme/my_swd_theme.R")
```
## Racial Wealth Gap {.tabset}

### **Synopsis**

**Problem:**
Racial wealth inequality has not decreased over the last 50 years, and the gap is still very large. This gap persists due to inequities in wealth, income, education, among others, and are largely attributable to decades of institutionalized and systemic racism. The purpose of this analysis is to explore racial wealth trends from 1963 to 2016 and analyze the gaps.

------------

**Packages Required:**
```
library(tidyverse)
library(knitr)
library(kableExtra)
library(scales)
library(plotly)
library(xfun)
```
-------------

### Data Preparation {.tabset}

#### Data Import
The 10 datasets originally pulled from the [Urban Institute](https://apps.urban.org/features/wealth-inequality-charts/) and [US Census](https://www.census.gov/data/tables/time-series/demo/income-poverty/historical-income-households.html).  

Retrievable from this [Github Repo](https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-02-09).  
<hr>

```
lifetime_earn <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv')
```
```
student_debt <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv')
```
```
retirement <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv')
```
```
home_owner <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv')
```
```
race_wealth <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv')
```
```
income_time <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv')
```
```
income_limits <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv')
```
```
income_aggregate <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv')
```
```
income_distribution <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv')
```
```
income_mean <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv')
```

#### Data Dictionary



`lifetime_earn.csv` ([Source:](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/lifetime_earn.csv)):

Average lifetime earning by race/gender

```{r}
kable(data1.desc)
```
***

`student_dept.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/student_debt.csv)):

Average family student load debt for aged 25-55, by race and year normalized to 2016 dollars.  

```{r}
kable(data2.desc)
```
***

`retirement.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/retirement.csv)):

Average family liquid retirement savings normalized to 2016 dollars.

```{r}
kable(data3.desc)
```
***

`home_owner.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/home_owner.csv)):

Home ownership percentage for families.

```{r}
kable(data4.desc)
```
***

`race_wealth.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/race_wealth.csv)):  
Family wealth by race/year/measure normalized to 2016, with measures of central tendency with mean and median.

```{r}
kable(data5.desc)
```
***

`income_time.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_time.csv)):  
Family-level income by percentile and year.

```{r}
kable(data6.desc)
```
***

`income_limits.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_limits.csv)):  
Familial income limits for each fifth and top 5% of households by year and race.

```{r}
kable(data7.desc)
```
***

`income_aggregate.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_aggregate.csv)):  
Share of aggregate income received by each fifth and top 5% of each racial group/household.

```{r}
kable(data8.desc)
```
***

`income_distribution.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_distribution.csv)):  
Households by total money income, race, and hispanic origin of householder separated by year and income groups.

```{r}
kable(data9.desc)
```
***

`income_mean.csv` ([Source](https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-09/income_mean.csv)):  
Mean income received by each fifth and top 5% of each racial group.

```{r}
kable(data10.desc)
```

### Exploratory Data Analysis (EDA) {.tabset}

#### Family Wealth Analysis


```{r}
# race_mean_time <- race_wealth |> 
#   filter(type == "Average") |> # filter by average/mean wealth (other option is by median)
#   group_by(year, race) |> 
#   summarise(wealth_family = wealth_family) 
# 
# rw_mean_time_plot <- ggplot(race_mean_time, aes(x = year, y = wealth_family, color = race)) +
#   geom_line() +
#   geom_point(size = .5) +
#   scale_color_brewer(palette = "Set2") +
#   scale_y_continuous(limits = c(0, 950000), breaks = seq(0, 950000, 150000), labels = label_dollar()) +
#   labs(
#     title = "Average family wealth over time, by race",
#     x = "Year",
#     y = "Family Wealth",
#   ) +
#   my_swd_theme() + theme(
#     legend.position = "top",
#     axis.title.x = element_blank(),
#     axis.title.y = element_blank(),
#     plot.title = element_text(size = 14, face = "bold"),
#   )
# 
# ggplotly(rw_mean_time_plot) |> 
#   layout(
#     legend = list( # the orientation = "h" arg fixes the legend position "top" issue
#       orientation = "h", 
#       x = .05, 
#       y = 1.04,
#       title = list(
#         text = ""
#       )
#       )
#   )
```





**Median family wealth (1963-2016)**  
Family wealth a a family's assets (i.e., savings, real estate, businesses) minus debt. Median wealth—or the wealth of the household at the middle of a distribution—represents the experience of the typical family. 

```{r}
race_median_time <- race_wealth |> 
  filter(type == "Median") |> # filter by median wealth (other option is by average)
  group_by(year, race) |> 
  mutate(race = as_factor(race)) |> 
  summarise(wealth_family = wealth_family) 


ggplot(race_median_time, aes(x = year, y = wealth_family, color = race)) +
  geom_line() +
  geom_point(size = .5) +
  scale_color_brewer(palette = "Set2") +
  scale_y_continuous(limits = c(0, 200000), breaks = seq(0, 200000, 50000), labels = label_dollar()) +
  labs(
    title = "Median family wealth over time, by race",
    x = "Year",
    y = "Family Wealth",
  ) +
  my_swd_theme() + theme(
    legend.position = "top",
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),
    plot.title = element_text(size = 14, face = "bold"),
  )
```
In 1963, the median of white family wealth was \$47,654 which is **19.3 times** greater than the median of non-white family wealth. White median family wealth was \$171,000 in 2016, which is **9.8 times** greater than Black median family wealth of $17,409. While the median wealth gap has lessened from 1963 to 2016, the gap trends has shown to be consistent over time and the disparities remain significant.

<br><br>

#### Income Analysis

**Lifetime Earnings**  
Those with lesser incomes might find it more difficult to save. 
<br><br>

```{r}

lifetime_earn_plot <- lifetime_earn |> 
  mutate(
    race = as_factor(race)
  )

ggplot(lifetime_earn_plot, aes(x = race, y = lifetime_earn, fill = race)) + 
  geom_col() + 
  scale_y_continuous(limits = c(0, 3000000), breaks = seq(0, 3000000, 750000), labels = label_dollar()) +
  scale_fill_ipsum() +
  facet_wrap(~gender) +
  labs(
    title = "Lifetime Earnings Inequity",
    subtitle = "Average Accumulated Real Lifetime Earnings at Ages 58–62 (Born 1950-54) by Gender and Race/Ethnicity",
    y = "Lifetime Earnings"
  ) +
  theme_bw() + theme(
    panel.grid = element_blank(),
    axis.text.x = element_blank(),
    axis.title.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.title.y = element_blank(),
    legend.title = element_blank(),
    legend.position = c(.85, .80),
    plot.title = element_text(size = 14, face = "bold"),
    # plot.title.position = "plot",
    plot.subtitle = element_text(size = 8, margin = margin(0,0,.5,0,"cm")),
    plot.margin = margin(1, 1, 1, 1, "cm"),
  )
```

The average lifetime income of a white male is \$2.7 million, compared to \$1.8 million for black men and \$2.0 million for Hispanic men. For women, the disparity in lifetime earnings is less pronounced: the average white woman makes \$1.5 million, compared to \$1.3 million for black women and $1.1 million for Hispanic women. Part of these differences can be attributed to historical disadvantages that still have an impact on future generations.

<br><br>
















